name: Daily Market News Update

on:
  schedule:
    # ── 뉴스 카드: 매 시간 정각 ──────────────────────────────
    - cron: '0 * * * *'
    # ── 주요 경제지표 발표 직후 추가 트리거 ──────────────────
    # 13:35 UTC (ET 8:35am) : CPI·Core CPI·PCE·고용·소매판매 발표 후
    #   → BLS(매월 2~3주차 수), BEA, Census 등 8:30am ET 발표 지표
    - cron: '35 13 * * *'
    # 15:05 UTC (ET 10:05am) : ISM PMI(제조/서비스)·UMich 소비심리 발표 후
    #   → 10:00am ET 발표 지표
    - cron: '5 15 * * *'
    # 19:05 UTC (ET 14:05pm) : FOMC 금리 결정 발표 후 (수요일)
    - cron: '5 19 * * 3'
  workflow_dispatch: # 수동 실행 가능

jobs:
  update-news:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install requests beautifulsoup4 yfinance deep-translator

      - name: Run update script
        run: python scripts/update_news.py

      - name: Commit and push changes
        run: |
          git config --global user.name "Market News Bot"
          git config --global user.email "bot@marketnews.com"
          git add index.html
          git commit -m "Automated Market News Update: $(date +'%Y-%m-%d %H:%M')" || echo "No changes to commit"
          git push
